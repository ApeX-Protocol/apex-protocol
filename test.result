
  Amm
owner: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
feeToSetter: 0x90F79bf6EB2c4f870365E785982E1f101E93b906
config:  0x5FbDB2315678afecb367f032d93F642f64180aa3
amm factory:  0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0
priceOracle:  0xCf7Ed3AccA5a467e9e704C703E8D87F634fB0Fc9
AAA: 0x5FC8d32690cc91D4c39d9d3abcBD16989F875707
USDT: 0x0165878A594ca255338adfa4d48449f69242Eb8F
amm:  0x0e97f8174868843B5F3ab5deE27F4faA0EF11878
margin:  0xA51c1fc2f0D1a1b8494Ed1FE312d7C3a78Ed91C0
---------test begin---------

    1) owner add liquidity
owner: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
feeToSetter: 0x90F79bf6EB2c4f870365E785982E1f101E93b906
config:  0x9A9f2CCfdE556A7E9Ff0848998Aa4a0CFD8863AE
amm factory:  0x3Aa5ebB10DC797CAC828524e59A333d0A371443c
priceOracle:  0xc6e7DF5E7b4f2A278906862b61205850344D4e7d
AAA: 0x4ed7c70F96B99c776995fB64377f0d4aB3B0e1C1
USDT: 0x322813Fd9A801c5507c9de605d63CEA4f2CE6c44
amm:  0x6d69C5b9CBDc18AaBb81D0d27d2263ae75032b93
margin:  0x67d269191c92Caf3cD7723F116c85e6E9bf55933
---------test begin---------

    2) check swap input in large size 
owner: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
feeToSetter: 0x90F79bf6EB2c4f870365E785982E1f101E93b906
config:  0x1613beB3B2C4f22Ee086B2b38C1476A3cE7f78E8
amm factory:  0xf5059a5D33d5853360D16C683c16e67980206f36
priceOracle:  0x95401dc811bb5740090279Ba06cfA8fcF6113778
AAA: 0x70e0bA845a1A0F2DA3359C97E0285013525FFC49
USDT: 0x4826533B4897376654Bb4d4AD88B7faFD0C98528
amm:  0x153BdA22B2Cc0509d3EAEBbf09Dd8f79DEC07aF9
margin:  0x36C02dA8a0983159322a80FFE9F24b1acfF8B570
---------test begin---------

    3) check swap output oversize  

  BondPoolFactory contract
    updateParams
      ✓ updateParams right
      ✓ updateParams with wrong discount
      ✓ updateParams with wrong vestingTerm
      ✓ updateParams with non-admin
    createPool
      ✓ createPool right
      ✓ createPool with non-admin

  BondPool contract
    deposit
      ✓ deposit right
    redeem
      ✓ redeem right

  PCVTreasury contract
    addLiquidityToken
      ✓ add a new lpToken
      ✓ add a lpToken already added
      ✓ not admin add a lpToken
    addBondPool
      ✓ add a new bondPool
      ✓ add a bondPool already added
      ✓ not admin add a bondPool
    deposit
      ✓ deposit with unsupported bondPool
      ✓ deposit with unsupported lpToken
      ✓ deposit with not approved
      ✓ deposit with not enough apeX
slpLeft: 1000
slpInTreasury: 1000
apeXLeft: 2000
apeXInBondPool: 1000
      ✓ deposit success
    withdraw
      ✓ admin withdraw
      ✓ other withdraw
    grantApeX
      ✓ other grantApeX
      ✓ admin grantApeX

  Config contract
    set initMarginRatio
      ✓ set correct ratio
      ✓ revert when set wrong ratio
      ✓ reverted if addr1 set
    set liquidateThreshold
      ✓ set correct threshold
      ✓ revert when set wrong threshold
    set liquidateFeeRatio
      ✓ set correct fee ratio
      ✓ revert when set wrong fee ratio
    registerRouter
      ✓ revert when register a registered router
    unregisterRouter
      ✓ revert when unregister an unregister router
      ✓ unregister an registered router

  ERC20MerkleDrop
    Mint all elements
Reconstructed merkle root 0xa178ba2590c5523af85c7529f032c66c6d86d6fbe1faf8b99fa5ee97a4e614be
root 0xa178ba2590c5523af85c7529f032c66c6d86d6fbe1faf8b99fa5ee97a4e614be
      ✓ successful claim
      ✓ file tree claim

  Margin contract
    Liquidate

      4) "before each" hook for "Liquidate user's position"

  Margin contract
    Liquidity

      5) "before each" hook for "Add liquidity at first success with autoStake"

  Margin contract
    Position

      6) "before each" hook for "Open position withWallet"

  Margin contract
    Rebase

      7) "before each" hook for "Rebase the reserve"

  Invitation
owner: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
alice: 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
invitation address:  0x2F54D1563963fC04770E85AF819c89Dc807f6a06
    ✓ A invite B, then B invite C, then C invite A

  Margin contract
    flash loan attack
      ✓ can when open and removeMargin in one block
      ✓ revert when open and close in one block
    addMargin
      ✓ revert when no enough allowance by router
      ✓ add correct margin from router
      ✓ margin remain baseToken, trader profit it through margin.sol
      ✓ add wrong margin
      operate margin with old position
        ✓ add an old position
    remove margin
      ✓ remove correct margin
      ✓ remove correct margin eth
      ✓ no position, have baseToken, remove wrong margin
      ✓ no position and no baseToken, remove margin
      remove margin with old position
        ✓ withdraw maximum margin from an old short position
        ✓ withdraw maximum margin from an old short position
        ✓ withdraw margin from an old position
        ✓ withdraw maximum margin from an old long position
        ✓ withdraw from an old position's fundingFee
        ✓ withdraw from an old position's unrealizedPnl
    openPosition
      ✓ open correct long position
      ✓ open correct short position
      ✓ open wrong position
      ✓ open position with bad liquidity in amm
      open long first, then open long
        ✓ old: quote -10, base 11; add long 5X position 1: quote -5, base +5; new: quote -15, base 17; add margin 1 first
        ✓ old: quote -10, base 11; add long 5X position 1: quote -5, base +5; new: quote -15, base 16; reverted
      open short first, then open long
        ✓ old: quote 10, base -9; add long 5X, delta position: quote -5, base +5; new: quote 5, base -4
        ✓ old: quote 10, base -9; add long 21X, delta position: quote -21, base +21; new: quote -11, base 12
        ✓ old: quote 10, base -9; new price=2 and add margin 10; add long 20X, delta position: quote -20, base +10; new: quote -10, base 11
        ✓ old: quote 10, base -9; new price=2 and add margin 10; add long 20X, delta position: quote -20, base +30; new: quote -10, base 21
        ✓ old: quote 10, base -9; add long 22X, delta position 1: quote -22, base +22; new: quote -12, base 13; reverted
      set new initMarginRatio when open position
        ✓ old: quote 10, base -9, set new initMarginRatio; add long 19X, delta position: quote -19, base +19; new: quote -9, base 10
        ✓ old: quote 10, base -9, set new initMarginRatio; add long 20X, reverted
        ✓ old: quote 10, base -9, set new initMarginRatio; add long 109X, delta position: quote -109, base +109; new: quote 99, base 100
    close position
      ✓ close all position
      ✓ close position partly
      ✓ close Null position, reverted
      ✓ close wrong position, reverted
      ✓ close liquidatable position, no remain left
      ✓ close liquidatable position, but have remain
    liquidate
      ✓ liquidate 0 position, reverted
      ✓ liquidate healthy position, reverted
      ✓ liquidate non liquidatable position
      ✓ liquidate liquidatable position, have bonus
      ✓ liquidate liquidatable position, no bonus
    get withdrawable margin
      ✓ quote 0, base 0; withdrawable is 0
      ✓ quote 0, base 1; withdrawable is 1
      ✓ quote -10, base 11; withdrawable is 0
      ✓ quote -10, base 12; withdrawable is 1
      ✓ quote 10, base -9; withdrawable is 0
      ✓ quote 10, base -8; withdrawable is 1
      ✓ remove withdrawable margin, no more
    updateCPF
      ✓ can update frequently and directly
      ✓ can update frequently and indirectly
    calFundingFee
      ✓ check funding fee at different timestamp

  nftSquid contract
nftSquid:  0x622940CE413F799b63566c3ebc185eC2Bc1951D8
nftSquid:  0x622940CE413F799b63566c3ebc185eC2Bc1951D8
nftSquid symbol  APEXNFT
balance:  9999

    8) burn  4560 in  0 month

  PriceOracleForTest contract
    query
      ✓ get reserves
      ✓ query quote

  PriceOracle contract
    quoteFromAmmTwap
quoteAmount: 1999840305
      ✓ quote from amm twap
    quote
quoteAmount: 1999840305
      ✓ quote big number
indexPrice: 1999840305000000000000
      ✓ getIndexPrice: base < quote
    compare ammTwap & indexPrice
quoteAmountFromTwap: 1999840305
quoteAmountFromIndex: 1999840305
      ✓ compare
    getMarkPrice
markPrice: 2000000000000000000000
      ✓ getMarkPrice: price > 1
markPrice: 2000000000000000
      ✓ getMarkPrice: price < 1
    getMarkPriceAcc
markPriceAcc: 475
      ✓ getMarkPriceAcc: base < quote
markPriceAcc: 951814396
      ✓ getMarkPriceAcc: base > quote
    getPremiumFraction
premiumFraction: 11574998297177458037960
      ✓ getPremiumFraction: base < quote
premiumFraction: 5775925080301691
      ✓ getPremiumFraction: base > quote

  Router contract
    addLiquidity
      ✓ addLiquidity without pcv
      ✓ addLiquidity with pcv
    addLiquidityETH
      ✓ addLiquidityETH without pcv
      ✓ addLiquidity with pcv
    removeLiquidity
      ✓ removeLiquidity right
    removeLiquidityETH
      ✓ removeLiquidityETH right
    deposit
      ✓ deposit right
    depositETH
      ✓ depositETH right
    withdraw
      ✓ withdraw right
    openPositionWithMargin
      ✓ openPositionWithMargin open long
      ✓ openPositionWithMargin open short
    openPositionWithWallet
      ✓ openPositionWithWallet open long
      ✓ openPositionWithWallet open short
    openPositionETHWithWallet
      ✓ openPositionETHWithWallet open long
      ✓ openPositionETHWithWallet open short
    closePosition
      ✓ closePosition right

  stakingPool contract
    stake
      ✓ reverted when stake invalid amount
      ✓ reverted when exceed balance
      ✓ reverted when invalid lock interval
      ✓ stake successfully
      ✓ stake twice, no lock

      9) stake twice, with one year lock
    unstake
      ✓ stake, process reward, unstake, transfer apeX 
    batchWithdraw
      ✓ batchWithdraw unlocked deposit
      ✓ batchWithdraw unlocked esDeposit
      ✓ batchWithdraw locked deposit
      ✓ batchWithdraw locked esDeposit
    vest
      ✓ unlock too early
      ✓ stake, process reward to apeXPool, unstake from slpPool, unstake from apeXPool
    pendingYieldRewards
      ✓ stake, process reward to apeXPool, unstake from slpPool, unstake from apeXPool
    forceWithdraw
      ✓ revert when force withdraw nonReward
      ✓ revert when force withdraw from slp pool
      ✓ revert when force withdraw invalid depositId
      ✓ can withdraw
    stApeXBalance
      ✓ vest dont change stApeXBalance
      ✓ stake, stakeEsApeX, batchWithdraw change stApeXBalance

  stakingPoolFactory contract
    createPool
      ✓ create a pool and register
      ✓ revert when create pool with invalid initTimestamp
      ✓ revert when create pool with invalid poolToken
    registerPool
      ✓ register an unregistered stakingPool
      ✓ revert when register a registered stakingPool
    updateApeXPerSec
      ✓ update apex rewards per sec
      ✓ revert when update apeXPerSec in next block
    changePoolWeight
      ✓ change pool weight
    calStakingPoolApeXReward
      ✓ calculate reward after some time
    transferYieldTo
      ✓ reverted when transfer apeX by unauthorized account
    transferEsApeXTo
      ✓ reverted when transfer EsApeX by unauthorized account
    transferEsApeXFrom
      ✓ reverted when transfer EsApeX by unauthorized account
    burnEsApeX
      ✓ reverted when burn EsApeX by unauthorized account
    mintEsApeX
      ✓ reverted when mint EsApeX by unauthorized account
    mintStApeX
      ✓ reverted when mint StApeX by unauthorized account
    burnStApeX
      ✓ reverted when burn StApeX by unauthorized account

  VIPNFT contract
ct: 1645877871

    10) claim

·--------------------------------------------------------------------------------------|---------------------------|-------------|-----------------------------·
|                                 [90mSolc version: 0.8.2[39m                                  ·  [90mOptimizer enabled: true[39m  ·  [90mRuns: 200[39m  ·  [90mBlock limit: 30000000 gas[39m  │
·······················································································|···························|·············|······························
|  [32m[1mMethods[22m[39m                                                                                                                                                     │
························································|······························|·············|·············|·············|···············|··············
|  [1mContract[22m                                             ·  [1mMethod[22m                      ·  [32mMin[39m        ·  [32mMax[39m        ·  [32mAvg[39m        ·  [1m# calls[22m      ·  [1meur (avg)[22m  │
························································|······························|·············|·············|·············|···············|··············
|  [90m@openzeppelin/contracts/token/ERC20/ERC20.sol:ERC20[39m  ·  approve                     ·      [36m46163[39m  ·      [31m46223[39m  ·      46193  ·            [90m2[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mAmmFactory[39m                                           ·  createAmm                   ·          -  ·          -  ·    2835410  ·            [90m6[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mAmmFactory[39m                                           ·  initAmm                     ·          -  ·          -  ·     126693  ·            [90m3[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mApeXVIPNFT[39m                                           ·  addManyToWhitelist          ·          -  ·          -  ·      46962  ·            [90m1[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mBondPool[39m                                             ·  deposit                     ·          -  ·          -  ·     285110  ·            [90m2[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mBondPool[39m                                             ·  redeem                      ·          -  ·          -  ·      76035  ·            [90m1[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mBondPoolFactory[39m                                      ·  createPool                  ·    [36m1706358[39m  ·    [31m1706424[39m  ·    1706380  ·            [90m3[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mBondPoolFactory[39m                                      ·  updateParams                ·          -  ·          -  ·      39040  ·            [90m1[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mConfig[39m                                               ·  registerRouter              ·      [36m47452[39m  ·      [31m47464[39m  ·      47463  ·           [90m70[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mConfig[39m                                               ·  setBeta                     ·          -  ·          -  ·      30250  ·           [90m62[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mConfig[39m                                               ·  setInitMarginRatio          ·      [36m30019[39m  ·      [31m30031[39m  ·      30031  ·           [90m66[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mConfig[39m                                               ·  setLiquidateFeeRatio        ·          -  ·          -  ·      30064  ·           [90m63[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mConfig[39m                                               ·  setLiquidateThreshold       ·          -  ·          -  ·      27242  ·           [90m63[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mConfig[39m                                               ·  setMaxCPFBoost              ·          -  ·          -  ·      27150  ·           [90m52[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mConfig[39m                                               ·  setPriceOracle              ·      [36m30719[39m  ·      [31m30731[39m  ·      30730  ·           [90m68[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mConfig[39m                                               ·  unregisterRouter            ·          -  ·          -  ·      25643  ·            [90m1[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mERC721PresetMinterPauserAutoId[39m                       ·  mint                        ·          -  ·          -  ·     271601  ·            [90m6[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mEsAPEX[39m                                               ·  approve                     ·          -  ·          -  ·      46146  ·            [90m9[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mInvitation[39m                                           ·  acceptInvitation            ·      [36m96995[39m  ·     [31m137029[39m  ·     117014  ·            [90m3[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMargin[39m                                               ·  addMargin                   ·      [36m49830[39m  ·      [31m84030[39m  ·      66930  ·            [90m2[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMargin[39m                                               ·  closePosition               ·      [36m97068[39m  ·     [31m135306[39m  ·     119490  ·            [90m5[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMargin[39m                                               ·  liquidate                   ·      [36m97767[39m  ·     [31m136435[39m  ·     117101  ·            [90m2[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMargin[39m                                               ·  openPosition                ·     [36m120669[39m  ·     [31m217260[39m  ·     190206  ·           [90m68[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMargin[39m                                               ·  removeMargin                ·      [36m94704[39m  ·     [31m135228[39m  ·     115791  ·           [90m16[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMargin[39m                                               ·  updateCPF                   ·      [36m54376[39m  ·      [31m73850[39m  ·      64113  ·            [90m4[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMerkleDistributor[39m                                    ·  claim                       ·      [36m61565[39m  ·      [31m88800[39m  ·      77947  ·            [90m6[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMockAmm[39m                                              ·  initialize                  ·      [36m66553[39m  ·      [31m66577[39m  ·      66575  ·           [90m54[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMockAmm[39m                                              ·  setPrice                    ·      [36m23661[39m  ·      [31m26473[39m  ·      25996  ·            [90m6[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMockAmm[39m                                              ·  setReserves                 ·          -  ·          -  ·      44011  ·           [90m52[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMockConfig[39m                                           ·  setBeta                     ·          -  ·          -  ·      28176  ·            [90m3[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMockConfig[39m                                           ·  setPriceOracle              ·          -  ·          -  ·      28480  ·            [90m3[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMockFactory[39m                                          ·  createPair                  ·          -  ·          -  ·    4176925  ·           [90m52[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMockFactory[39m                                          ·  initialize                  ·     [36m119889[39m  ·     [31m119913[39m  ·     119909  ·           [90m52[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMockFlashAttacker[39m                                    ·  attack2                     ·          -  ·          -  ·     376507  ·            [90m1[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMockMargin[39m                                           ·  initialize                  ·          -  ·          -  ·     111772  ·            [90m3[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMockPriceOracle[39m                                      ·  setMarkPrice                ·          -  ·          -  ·      26461  ·            [90m5[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMockPriceOracle[39m                                      ·  setPf                       ·      [36m43576[39m  ·      [31m43864[39m  ·      43720  ·            [90m2[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMockRouter[39m                                           ·  addMargin                   ·      [36m76340[39m  ·     [31m127640[39m  ·     109764  ·           [90m71[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMockRouter[39m                                           ·  removeMargin                ·     [36m107269[39m  ·     [31m166146[39m  ·     133221  ·            [90m8[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMockRouter[39m                                           ·  setMarginContract           ·      [36m43879[39m  ·      [31m43891[39m  ·      43890  ·           [90m52[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMockRouter[39m                                           ·  withdrawETH                 ·          -  ·          -  ·     126825  ·            [90m1[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMockToken[39m                                            ·  approve                     ·      [36m29121[39m  ·      [31m46245[39m  ·      45702  ·          [90m165[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMockToken[39m                                            ·  deposit                     ·          -  ·          -  ·      33449  ·            [90m1[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMockToken[39m                                            ·  mint                        ·      [36m51283[39m  ·      [31m68467[39m  ·      61802  ·          [90m233[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMockToken[39m                                            ·  transfer                    ·      [36m34375[39m  ·      [31m46675[39m  ·      40525  ·            [90m2[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMockUniswapV3Factory[39m                                 ·  setPool                     ·      [36m67608[39m  ·      [31m67620[39m  ·      67616  ·           [90m10[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMockUniswapV3Pool[39m                                    ·  initialize                  ·          -  ·          -  ·      91336  ·            [90m7[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMockUniswapV3Pool[39m                                    ·  setLiquidity                ·          -  ·          -  ·      43640  ·           [90m10[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMockUniswapV3Pool[39m                                    ·  writeObservation            ·      [36m38382[39m  ·      [31m38759[39m  ·      38457  ·           [90m35[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMyAmm[39m                                                ·  initialize                  ·      [36m89126[39m  ·      [31m89138[39m  ·      89134  ·           [90m10[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMyAmm[39m                                                ·  setReserves                 ·      [36m26931[39m  ·      [31m44103[39m  ·      39191  ·           [90m14[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mMyToken[39m                                              ·  transfer                    ·      [36m36698[39m  ·      [31m53798[39m  ·      52815  ·           [90m18[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mPairFactory[39m                                          ·  init                        ·          -  ·          -  ·      69095  ·           [90m16[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mPCVTreasury[39m                                          ·  addBondPool                 ·      [36m47464[39m  ·      [31m47476[39m  ·      47467  ·            [90m8[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mPCVTreasury[39m                                          ·  addLiquidityToken           ·      [36m47485[39m  ·      [31m47497[39m  ·      47496  ·           [90m11[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mPCVTreasury[39m                                          ·  deposit                     ·          -  ·          -  ·      99493  ·            [90m1[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mPCVTreasury[39m                                          ·  grantApeX                   ·          -  ·          -  ·      60244  ·            [90m1[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mPCVTreasury[39m                                          ·  withdraw                    ·          -  ·          -  ·      67496  ·            [90m1[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mPriceOracle[39m                                          ·  initialize                  ·          -  ·          -  ·      67034  ·           [90m10[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mPriceOracle[39m                                          ·  setupTwap                   ·    [36m5423543[39m  ·    [31m5462971[39m  ·    5428472  ·            [90m8[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mPriceOracle[39m                                          ·  updateAmmTwap               ·      [36m65931[39m  ·      [31m83031[39m  ·      69351  ·           [90m10[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mPriceOracleForTest[39m                                   ·  setReserve                  ·      [36m67046[39m  ·      [31m67070[39m  ·      67068  ·           [90m50[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mRouter[39m                                               ·  addLiquidity                ·    [36m7450747[39m  ·    [31m7457176[39m  ·    7452552  ·           [90m10[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mRouter[39m                                               ·  addLiquidityETH             ·    [36m7461361[39m  ·    [31m7467792[39m  ·    7462433  ·            [90m6[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mRouter[39m                                               ·  closePosition               ·          -  ·          -  ·     307114  ·            [90m1[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mRouter[39m                                               ·  deposit                     ·          -  ·          -  ·     102249  ·            [90m4[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mRouter[39m                                               ·  depositETH                  ·          -  ·          -  ·     100067  ·            [90m1[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mRouter[39m                                               ·  openPositionETHWithWallet   ·     [36m379788[39m  ·     [31m379830[39m  ·     379809  ·            [90m2[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mRouter[39m                                               ·  openPositionWithMargin      ·     [36m329652[39m  ·     [31m329694[39m  ·     329673  ·            [90m2[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mRouter[39m                                               ·  openPositionWithWallet      ·     [36m379910[39m  ·     [31m379952[39m  ·     379938  ·            [90m3[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mRouter[39m                                               ·  removeLiquidity             ·          -  ·          -  ·     177134  ·            [90m1[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mRouter[39m                                               ·  removeLiquidityETH          ·          -  ·          -  ·     192881  ·            [90m1[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mRouter[39m                                               ·  withdraw                    ·          -  ·          -  ·     154113  ·            [90m1[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mStakingPool[39m                                          ·  batchWithdraw               ·     [36m147559[39m  ·     [31m203172[39m  ·     175997  ·            [90m8[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mStakingPool[39m                                          ·  forceWithdraw               ·          -  ·          -  ·     167563  ·            [90m1[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mStakingPool[39m                                          ·  processRewards              ·     [36m163646[39m  ·     [31m172671[39m  ·     167256  ·           [90m10[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mStakingPool[39m                                          ·  stake                       ·     [36m249273[39m  ·     [31m396809[39m  ·     321286  ·           [90m24[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mStakingPool[39m                                          ·  stakeEsApeX                 ·     [36m288463[39m  ·     [31m328412[39m  ·     301779  ·            [90m3[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mStakingPool[39m                                          ·  vest                        ·     [36m226431[39m  ·     [31m274008[39m  ·     245008  ·            [90m4[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mStakingPoolFactory[39m                                   ·  changePoolWeight            ·          -  ·          -  ·      45882  ·            [90m1[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mStakingPoolFactory[39m                                   ·  createPool                  ·    [36m3099595[39m  ·    [31m3116707[39m  ·    3110406  ·           [90m57[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mStakingPoolFactory[39m                                   ·  registerPool                ·     [36m108917[39m  ·     [31m108929[39m  ·     108923  ·            [90m2[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mStakingPoolFactory[39m                                   ·  setEsApeX                   ·      [36m54600[39m  ·      [31m54612[39m  ·      54612  ·           [90m36[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mStakingPoolFactory[39m                                   ·  setLockTime                 ·      [36m37106[39m  ·      [31m37130[39m  ·      37127  ·            [90m7[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mStakingPoolFactory[39m                                   ·  setMinRemainRatioAfterBurn  ·          -  ·          -  ·      53188  ·            [90m4[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mStakingPoolFactory[39m                                   ·  setRemainForOtherVest       ·      [36m33191[39m  ·      [31m53091[39m  ·      51101  ·           [90m40[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mStakingPoolFactory[39m                                   ·  setStApeX                   ·      [36m54635[39m  ·      [31m54647[39m  ·      54646  ·           [90m36[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [90mStakingPoolFactory[39m                                   ·  updateApeXPerSec            ·          -  ·          -  ·      44244  ·            [90m4[39m  ·          [32m[90m-[32m[39m  │
························································|······························|·············|·············|·············|···············|··············
|  [32m[1mDeployments[22m[39m                                                                         ·                                         ·  [1m% of limit[22m   ·             │
·······················································································|·············|·············|·············|···············|··············
|  AmmFactory                                                                          ·    [36m3581185[39m  ·    [31m3581197[39m  ·    3581195  ·       [90m11.9 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  ApeXVIPNFT                                                                          ·          -  ·          -  ·    3718231  ·       [90m12.4 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  BondPoolFactory                                                                     ·    [36m2460702[39m  ·    [31m2460774[39m  ·    2460731  ·        [90m8.2 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  Config                                                                              ·          -  ·          -  ·    1120854  ·        [90m3.7 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  EsAPEX                                                                              ·          -  ·          -  ·     534366  ·        [90m1.8 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  Invitation                                                                          ·          -  ·          -  ·     566687  ·        [90m1.9 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  MarginFactory                                                                       ·    [36m4852393[39m  ·    [31m4852405[39m  ·    4852402  ·       [90m16.2 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  MerkleDistributor                                                                   ·          -  ·          -  ·     567767  ·        [90m1.9 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  MockAmm                                                                             ·          -  ·          -  ·     967973  ·        [90m3.2 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  MockBondPriceOracle                                                                 ·          -  ·          -  ·     126181  ·        [90m0.4 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  MockConfig                                                                          ·          -  ·          -  ·     797979  ·        [90m2.7 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  MockFactory                                                                         ·    [36m4621521[39m  ·    [31m4621533[39m  ·    4621532  ·       [90m15.4 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  MockFlashAttacker                                                                   ·          -  ·          -  ·     712698  ·        [90m2.4 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  MockMargin                                                                          ·          -  ·          -  ·     295281  ·          [90m1 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  MockPCVPolicy                                                                       ·          -  ·          -  ·     108519  ·        [90m0.4 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  MockPriceOracle                                                                     ·          -  ·          -  ·     225495  ·        [90m0.8 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  MockRouter                                                                          ·     [36m499363[39m  ·     [31m499375[39m  ·     499374  ·        [90m1.7 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  MockToken                                                                           ·    [36m1038410[39m  ·    [31m1038458[39m  ·    1038428  ·        [90m3.5 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  MockUniswapV3Factory                                                                ·          -  ·          -  ·     166537  ·        [90m0.6 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  MockUniswapV3Pool                                                                   ·    [36m1910650[39m  ·    [31m1910662[39m  ·    1910658  ·        [90m6.4 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  MockWETH                                                                            ·          -  ·          -  ·     576839  ·        [90m1.9 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  MyAmm                                                                               ·          -  ·          -  ·     362501  ·        [90m1.2 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  MyToken                                                                             ·    [36m1912990[39m  ·    [31m1933191[39m  ·    1932101  ·        [90m6.4 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  NftSquid                                                                            ·          -  ·          -  ·    4058080  ·       [90m13.5 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  PairFactory                                                                         ·          -  ·          -  ·     558011  ·        [90m1.9 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  PCVTreasury                                                                         ·    [36m1143105[39m  ·    [31m1143117[39m  ·    1143116  ·        [90m3.8 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  PriceOracle                                                                         ·          -  ·          -  ·    3096128  ·       [90m10.3 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  PriceOracleForTest                                                                  ·          -  ·          -  ·     895956  ·          [90m3 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  Router                                                                              ·    [36m3561061[39m  ·    [31m3561073[39m  ·    3561069  ·       [90m11.9 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  StakingPool                                                                         ·    [36m3235656[39m  ·    [31m3235668[39m  ·    3235667  ·       [90m10.8 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  StakingPoolFactory                                                                  ·          -  ·          -  ·    5228011  ·       [90m17.4 %[39m  ·          [32m[90m-[32m[39m  │
·······················································································|·············|·············|·············|···············|··············
|  StAPEX                                                                              ·          -  ·          -  ·    1770292  ·        [90m5.9 %[39m  ·          [32m[90m-[32m[39m  │
·--------------------------------------------------------------------------------------|-------------|-------------|-------------|---------------|-------------·

  151 passing (2m)
  10 failing

  1) Amm
       owner add liquidity:
     TransactionExecutionError: VM Exception while processing transaction: revert with reason "Amm: ONLY_MARGIN"
      at HardhatNode._manageErrors (node_modules/hardhat/src/internal/hardhat-network/provider/node.ts:1829:14)
      at HardhatNode._gatherTraces (node_modules/hardhat/src/internal/hardhat-network/provider/node.ts:1529:30)
      at processTicksAndRejections (node:internal/process/task_queues:96:5)
      at runNextTicks (node:internal/process/task_queues:65:3)
      at listOnTimeout (node:internal/timers:526:9)
      at processTimers (node:internal/timers:500:7)
      at HardhatNode._mineBlockWithPendingTxs (node_modules/hardhat/src/internal/hardhat-network/provider/node.ts:1649:23)
      at HardhatNode.mineBlock (node_modules/hardhat/src/internal/hardhat-network/provider/node.ts:458:16)
      at EthModule._sendTransactionAndReturnHash (node_modules/hardhat/src/internal/hardhat-network/provider/modules/eth.ts:1496:18)
      at HardhatNetworkProvider.request (node_modules/hardhat/src/internal/hardhat-network/provider/provider.ts:117:18)
      at EthersProviderWrapper.send (node_modules/@nomiclabs/hardhat-ethers/src/internal/ethers-provider-wrapper.ts:13:20)

  2) Amm
       check swap input in large size :
     AssertionError: Expected transaction to be reverted with AMM._update: TRADINGSLIPPAGE_TOO_LARGE, but other exception was thrown: TransactionExecutionError: VM Exception while processing transaction: revert with reason "Amm: ONLY_MARGIN"
  

  3) Amm
       check swap output oversize  :
     AssertionError: Expected transaction to be reverted with AMM._estimateSwap: INSUFFICIENT_LIQUIDITY, but other exception was thrown: TransactionExecutionError: VM Exception while processing transaction: revert with reason "Amm: ONLY_MARGIN"
  

  4) Margin contract
       "before each" hook for "Liquidate user's position":
     HardhatError: HH700: Artifact for contract "Factory" not found. Did you mean "AmmFactory"?
      at Artifacts._handleWrongArtifactForContractName (node_modules/hardhat/src/internal/artifacts.ts:473:11)
      at Artifacts._getArtifactPathFromFiles (node_modules/hardhat/src/internal/artifacts.ts:587:19)
      at Artifacts._getArtifactPath (node_modules/hardhat/src/internal/artifacts.ts:270:17)
      at Artifacts.readArtifact (node_modules/hardhat/src/internal/artifacts.ts:50:26)
      at getContractFactoryByName (node_modules/@nomiclabs/hardhat-ethers/src/internal/helpers.ts:100:20)
      at Context.<anonymous> (test/integration/Liquidation.js:46:25)

  5) Margin contract
       "before each" hook for "Add liquidity at first success with autoStake":
     HardhatError: HH700: Artifact for contract "Factory" not found. Did you mean "AmmFactory"?
      at Artifacts._handleWrongArtifactForContractName (node_modules/hardhat/src/internal/artifacts.ts:473:11)
      at Artifacts._getArtifactPathFromFiles (node_modules/hardhat/src/internal/artifacts.ts:587:19)
      at Artifacts._getArtifactPath (node_modules/hardhat/src/internal/artifacts.ts:270:17)
      at Artifacts.readArtifact (node_modules/hardhat/src/internal/artifacts.ts:50:26)
      at getContractFactoryByName (node_modules/@nomiclabs/hardhat-ethers/src/internal/helpers.ts:100:20)
      at Context.<anonymous> (test/integration/Liquidity.js:44:25)

  6) Margin contract
       "before each" hook for "Open position withWallet":
     HardhatError: HH700: Artifact for contract "Factory" not found. Did you mean "AmmFactory"?
      at Artifacts._handleWrongArtifactForContractName (node_modules/hardhat/src/internal/artifacts.ts:473:11)
      at Artifacts._getArtifactPathFromFiles (node_modules/hardhat/src/internal/artifacts.ts:587:19)
      at Artifacts._getArtifactPath (node_modules/hardhat/src/internal/artifacts.ts:270:17)
      at Artifacts.readArtifact (node_modules/hardhat/src/internal/artifacts.ts:50:26)
      at getContractFactoryByName (node_modules/@nomiclabs/hardhat-ethers/src/internal/helpers.ts:100:20)
      at Context.<anonymous> (test/integration/Position.js:44:25)

  7) Margin contract
       "before each" hook for "Rebase the reserve":
     HardhatError: HH700: Artifact for contract "Factory" not found. Did you mean "AmmFactory"?
      at Artifacts._handleWrongArtifactForContractName (node_modules/hardhat/src/internal/artifacts.ts:473:11)
      at Artifacts._getArtifactPathFromFiles (node_modules/hardhat/src/internal/artifacts.ts:587:19)
      at Artifacts._getArtifactPath (node_modules/hardhat/src/internal/artifacts.ts:270:17)
      at Artifacts.readArtifact (node_modules/hardhat/src/internal/artifacts.ts:50:26)
      at getContractFactoryByName (node_modules/@nomiclabs/hardhat-ethers/src/internal/helpers.ts:100:20)
      at Context.<anonymous> (test/integration/Rebase.js:44:25)

  8) nftSquid contract
       burn  4560 in  0 month:
     Error: VM Exception while processing transaction: reverted with reason string 'GAME_IS_ALREADY_END'
      at NftSquid.getApproved (@openzeppelin/contracts/token/ERC721/ERC721.sol:127)
      at processTicksAndRejections (node:internal/process/task_queues:96:5)
      at runNextTicks (node:internal/process/task_queues:65:3)
      at listOnTimeout (node:internal/timers:526:9)
      at processTimers (node:internal/timers:500:7)
      at HardhatNode._mineBlockWithPendingTxs (node_modules/hardhat/src/internal/hardhat-network/provider/node.ts:1649:23)
      at HardhatNode.mineBlock (node_modules/hardhat/src/internal/hardhat-network/provider/node.ts:458:16)
      at EthModule._sendTransactionAndReturnHash (node_modules/hardhat/src/internal/hardhat-network/provider/modules/eth.ts:1496:18)
      at HardhatNetworkProvider.request (node_modules/hardhat/src/internal/hardhat-network/provider/provider.ts:117:18)
      at EthersProviderWrapper.send (node_modules/@nomiclabs/hardhat-ethers/src/internal/ethers-provider-wrapper.ts:13:20)

  9) stakingPool contract
       stake
         stake twice, with one year lock:

      AssertionError: expected 19975750000 to be at least 19990000000
      + expected - actual

      -19975750000
      +19990000000
      
      at Context.<anonymous> (test/stakingPool.js:106:52)
      at runMicrotasks (<anonymous>)
      at processTicksAndRejections (node:internal/process/task_queues:96:5)
      at runNextTicks (node:internal/process/task_queues:65:3)
      at listOnTimeout (node:internal/timers:526:9)
      at processTimers (node:internal/timers:500:7)

  10) VIPNFT contract
       claim:
     InvalidInputError: Timestamp 1645878471 is lower than or equal to previous block's timestamp 1645906908
      at EvmModule._setNextBlockTimestampAction (node_modules/hardhat/src/internal/hardhat-network/provider/modules/evm.ts:92:13)
      at runMicrotasks (<anonymous>)
      at processTicksAndRejections (node:internal/process/task_queues:96:5)
      at runNextTicks (node:internal/process/task_queues:65:3)
      at listOnTimeout (node:internal/timers:526:9)
      at processTimers (node:internal/timers:500:7)
      at HardhatNetworkProvider.request (node_modules/hardhat/src/internal/hardhat-network/provider/provider.ts:117:18)
      at EthersProviderWrapper.send (node_modules/@nomiclabs/hardhat-ethers/src/internal/ethers-provider-wrapper.ts:13:20)
      at Context.<anonymous> (test/VIPNFT.js:48:5)



